# Build the HTML content using the exact text line-by-line from the document, wrapped in a styled template

# Define the main sections using the raw content from the file
header = """
<header>
  <h1>Ankit Anilbhai Patel</h1>
  <p class="title">Flutter Developer â€¢ Surat, India</p>
  <div class="contact-info">
    <span class="contact-item">ðŸ“§ patelankit70466@gmail.com</span>
    <span class="contact-item">ðŸ“ž +91 84606 24920</span>
    <span class="contact-item">ðŸ“ž +91 70466 20477</span>
    <a href="https://linkedin.com/in/ankit-patel-083434a2" target="_blank" class="contact-item">ðŸ”— LinkedIn</a>
  </div>
  <a href="https://ankit7046620.github.io/my-app-links/" target="_blank" class="portfolio-btn">
    <i class="fas fa-external-link-alt"></i> Resume & Portfolio
  </a>
</header>
"""

# Extract the entire text and prepare for HTML line-by-line wrapping
doc = Document("/mnt/data/v2_Ankit_Patel_Resume.docx")
lines = [para.text.strip() for para in doc.paragraphs if para.text.strip()]

# Helper to wrap content in sections
def section_wrapper(title, content):
    body = "<br>".join(escape(line) for line in content)
    return f"<section>\n<h2>{escape(title)}</h2>\n<p>{body}</p>\n</section>"

# Sections to group
section_titles = [
    "Professional Summary", "Core Competencies", "Professional Experience",
    "Key Projects", "Education", "Personal Details", "Contact Information"
]

# Parse into structured sections
structured = {}
current = None
for line in lines:
    if line in section_titles:
        current = line
        structured[current] = []
    elif current:
        structured[current].append(line)

# Generate HTML from structured data
body_html = header
for title in section_titles:
    if title in structured:
        body_html += section_wrapper(title, structured[title])

# Output final HTML content
body_html[:2000]  # Show beginning of generated HTML as preview
